@echo off

rem https://stackoverflow.com/questions/4051883/batch-script-how-to-check-for-admin-rights/11995662#11995662

goto check_Permissions

:check_Permissions
    echo Administrative permissions required. Detecting permissions...

    net session >nul 2>&1
    if %errorLevel% == 0 (
        echo Success: Administrative permissions confirmed.
        goto check_OS
    ) else (
        echo Failure: Current permissions inadequate.
        goto end
    )

:check_OS
	reg Query "HKLM\Hardware\Description\System\CentralProcessor\0" | find /i "x86" > NUL && set OS=32 || set OS=64

	echo This is a %OS%bit operating system. Running workaround...
	call "%~dp0undo_workaround_x%OS%.bat"

	if %errorlevel% EQU 0 (echo Success. ) else ( echo Error. )
	goto end

:end
	pause >nul
    